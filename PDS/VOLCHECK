         TITLE 'DISCLAIMER - INSTALLATION INSTRUCTIONS'
         MACRO
         #VTCFMT4
         MNOTE *,'       #VTCFMT4  VERSION 002 09/22/75  06/08/76  GPW'
.**********************************************************************
.*                                                                    *
.* #VTCFMT4                                                           *
.*                                                                    *
.* FUNCTION         CONSTRUCT A DSECT FOR A FORMAT 4 DSCB.            *
.*                                                                    *
.* DESCRIPTION      ASSIGN SYMBOLIC NAMES TO THE FIELDS IN A FORMAT 4 *
.*                  DATA SET CONTROL BLOCK (DSCB).  THE FIELD NAMES   *
.*                  CORRESPOND TO THE NAMES IN THE DATA AREAS MANUAL. *
.*                  A FORMAT 4 DSCB DESCRIBES THE VOLUME TABLE OF     *
.*                  CONTENTS.                                         *
.*                                                                    *
.* SYNTAX                    #VTCFMT4                                 *
.*                                                                    *
.* ERRORS           NO ERRORS ARE INDICATED.                          *
.*                                                                    *
.* EXAMPLE                   ORG   FMT4DSCB    ORG TO DATA AREA       *
.*                           #VTCFMT4                                 *
.*                                                                    *
.* GLOBAL SYMBOLS                                                     *
.*                                                                    *
.*                  NONE                                              *
.*                                                                    *
.* MACROS CALLED                                                      *
.*                                                                    *
.*                  NONE                                              *
.*                                                                    *
.* UPDATE SUMMARY                                                     *
.*                                                                    *
.*      VERSION   DATE     CHANGE                                     *
.*        002   06/08/76   VSAM DATA AREAS ADDED                      *
.*                                                                    *
.**********************************************************************
         SPACE 2
***********************************************************************
*                                                                     *
*        FORMAT 4 DSCB DESCRIPTION                                    *
*                                                                     *
*        VTOC DESCRIPTION                                             *
*                                                                     *
***********************************************************************
         SPACE 2
DS4KEY   DS    XL44                     KEY - VTOC NAME - 44X'04'
DS4IDFMT DS    X                        FORMAT 4 ID X'F4'
DS4HPCHR DS    XL5                      HIGHEST ADDR OF A FORMAT 1 DSCB
DS4DSREC DS    XL2                      NUMBER OF AVAILABLE DSCB'S
DS4HCCHH DS    XL4                      CCHH OF NEXT AVAILABLE ALT. TRK
DS4NOATK DS    XL2                      NUMBER OF REMAINING ALT. TRACKS
DS4VTOCI DS    X                        VTOC INDICATORS
DS4NOEXT DS    X                        NUMBER OF EXTENTS, ALWAYS 1
         DS    XL2                      RESERVED
DS4DEVSZ DS    XL4                      DEVICE SIZE
DS4DEVTK DS    XL2                      DEVICE TRACK LENGTH
DS4DEVZ  DS    0XL2                     KEYED RECORD OVERHEAD
DS4DEVI  DS    X                        NON-LAST KEYED RECORD OVERHEAD
DS4DEVL  DS    X                        LAST KEYED RECORD OVERHEAD
DS4DEVK  DS    X                        NON-KEYED RECORD OVERHEAD DIFF.
DS4DEVFG DS    X                        FLAG BYTE
DS4DEVTL DS    XL2                      DEVICE TOLERANCE
DS4DEVDT DS    X                        NUMBER OF DSCB'S PER TRACK
DS4DEVDB DS    X                        NUMBER OF DIRECTORY BLOCKS/TRK
DS4AMTIM DS    XL8                      VSAM TIME STAMP
DS4AMCAT DS    0XL3                     VSAM CATALOG INDICATORS
DS4VSIND DS    X                        VSAM INDICATORS
*              X'80'                      VOLUME OWNED BY VSAM CATALOG
DS4VSCRA DS    XL2                      RELATIVE TRACK ADDRESS OF CRA
DS4R2TIM DS    XL8                      VSAM VOLUME/CATALOG MATCH TIME
         DS    XL5                      RESERVED
DS4FTPTR DS    XL5                      POINTER TO FIRST FORMAT 6 DSCB
DS4VTOCE DS    XL10                     VTOC EXTENT DESCRIPTION
         DS    XL25                     RESERVED
         MEND
         MACRO
         #VTCFMT3
         MNOTE *,'       #VTCFMT3  VERSION 001 09/22/75  09/22/75  GPW'
.**********************************************************************
.*                                                                    *
.* #VTCFMT3                                                           *
.*                                                                    *
.* FUNCTION         CONSTRUCT A DSECT FOR A FORMAT 3 DSCB.            *
.*                                                                    *
.* DESCRIPTION      ASSIGN SYMBOLIC NAMES TO THE FIELDS IN A FORMAT 3 *
.*                  DATA SET CONTROL BLOCK (DSCB).  THE FIELD NAMES   *
.*                  CORRESPOND TO THE NAMES IN THE DATA AREAS MANUAL. *
.*                  A FORMAT 3 DSCB DESCRIBES DATA SET EXTENTS.       *
.*                                                                    *
.* SYNTAX                    #VTCFMT3                                 *
.*                                                                    *
.* ERRORS           NO ERRORS ARE INDICATED.                          *
.*                                                                    *
.* EXAMPLE                   ORG   FMT3DSCB    ORG TO DATA AREA       *
.*                           #VTCFMT3                                 *
.*                                                                    *
.* GLOBAL SYMBOLS                                                     *
.*                                                                    *
.*                  NONE                                              *
.*                                                                    *
.* MACROS CALLED                                                      *
.*                                                                    *
.*                  NONE                                              *
.*                                                                    *
.**********************************************************************
         SPACE 2
***********************************************************************
*                                                                     *
*        FORMAT 3 DSCB DESCRIPTION                                    *
*                                                                     *
*        DESCRIPTION OF FOURTH THROUGH SIXTEENTH EXTENTS OF A         *
*        DATA SET                                                     *
*                                                                     *
***********************************************************************
         SPACE 2
DS3KEY   DS    XL4                      KEY - 03030303
DS3EXT01 DS    XL10                     EXTENT  4 DESCRIPTION
DS3EXT02 DS    XL10                             5
DS3EXT03 DS    XL10                             6
DS3EXT04 DS    XL10                             7
DS3FMTID DS    X                        DSCB FORMAT 3 IDENTIFIER, X'F3'
DS3EXT05 DS    XL10                     EXTENT  8 DESCRIPTION
DS3EXT06 DS    XL10                             9
DS3EXT07 DS    XL10                            10
DS3EXT08 DS    XL10                            11
DS3EXT09 DS    XL10                            12
DS3EXT10 DS    XL10                            13
DS3EXT11 DS    XL10                            14
DS3EXT12 DS    XL10                            15
DS3EXT13 DS    XL10                            16
         MEND
         MACRO
         #VTCFMT1
         MNOTE *,'       #VTCFMT1  VERSION 002 09/22/75  03/20/78  GPW'
.**********************************************************************
.*                                                                    *
.* #VTCFMT1                                                           *
.*                                                                    *
.* FUNCTION         CONSTRUCT A DSECT FOR A FORMAT 1 DSCB.            *
.*                                                                    *
.* DESCRIPTION      ASSIGN SYMBOLIC NAMES TO THE FIELDS IN A FORMAT 1 *
.*                  DATA SET CONTROL BLOCK (DSCB).  THE FIELD NAMES   *
.*                  CORRESPOND TO THE NAMES IN THE DATA AREAS MANUAL. *
.*                                                                    *
.* SYNTAX                    #VTCFMT1                                 *
.*                                                                    *
.* ERRORS           NO ERRORS ARE INDICATED.                          *
.*                                                                    *
.* EXAMPLE                   ORG   FMT1DSCB    ORG TO DATA AREA       *
.*                           #VTCFMT1                                 *
.*                                                                    *
.* GLOBAL SYMBOLS                                                     *
.*                                                                    *
.*                  NONE                                              *
.*                                                                    *
.* MACROS CALLED                                                      *
.*                                                                    *
.*                  NONE                                              *
.*                                                                    *
.* UPDATE LOG                                                         *
.*                                                                    *
.*      DATE    VERSION     CHANGES                                   *
.*    03/20/78    002       SU60 FIELDS ADDED                         *
.*                                                                    *
.**********************************************************************
         SPACE 2
***********************************************************************
*                                                                     *
*        FORMAT 1 DSCB DESCRIPTION                                    *
*                                                                     *
***********************************************************************
         SPACE 2
DS1DSNAM DS    CL44                     DSNAME
DS1FMTID DS    X                        FORMAT 1 IDENTIFIER
DS1DSSN  DS    CL6                      DATA SET SERIAL NUMBER
DS1VOLSQ DS    XL2                      VOLUME SEQUENCE NUMBER
DS1CREDT DS    XL3                      CREATION DATE
DS1EXPDT DS    XL3                      EXPIRATION DATE
DS1NOPEV DS    X                        NUMBER OF EXTENTS
DS1NODBD DS    X                        NO OF BYTES USED IN LAST DIR BL
         DS    X                        RESERVED
DS1SYSCD DS    CL13                     SYSTEM CODE
DS1REFD  DS    XL3                      LAST DATE REFERENCED - SU 60
         DS    XL4                      RESERVED
DS1DSORG DS    XL2                      DATA SET ORGANIZATION
DS1RECFM DS    X                        RECORD FORMAT
DS1OPTCD DS    X                        OPTION CODE
DS1BLKL  DS    XL2                      BLOCKSIZE
DS1LRECL DS    XL2                      RECORD LENGTH
DS1KEYL  DS    X                        KEY LENGTH
DS1RKP   DS    XL2                      RELATIVE KEY POSITION
DS1DSIND DS    X                        DATA SET INDICATORS
*              X'80'                      LAST VOLUME FOR DATA SET
*              X'40'                      RACF DEFINED
*              X'20'                      BLOCK LEN MULT OF 8
*              X'10'                      READ/WRITE PASSWORD
*              X'08'                      RESERVED
*              X'04'                      MORE PASSWORD INDICATORS
*              X'02'                      UPDATED - SU 60
*              X'01'                      RESERVED
DS1SCALO DS    XL4                      ALLOCATION PARAMETERS
DS1LSTAR DS    XL3                      LAST BLOCK POINTER
DS1TRBAL DS    XL2                      LL PORTION OF DS1LSTAR
         DS    XL2                      RESERVED
DS1EXT1  DS    XL10                     FIRST EXTENT DESCRIPTION
DS1EXT2  DS    XL10                     SECOND EXTENT DESCRIPTION
DS1EXT3  DS    XL10                     THIRD EXTENT DESCRIPTION
DS1PTRDS DS    XL5                      CCHHTTR OF FORMAT 2 OR 3 DSCB
         MEND
         MACRO
&NAME    #SORT &FIELDS=(1,1,CH,A),&FIRST=,&LAST=,&LENGTH=
         MNOTE *,'       #SORT     VERSION 001 04/29/76  04/29/76  GPW'
.**********************************************************************
.*                                                                    *
.* #SORT                                                              *
.*                                                                    *
.* FUNCTION       GENERATE CODING TO SORT A TABLE IN ASCENDING OR     *
.*                DESCENDING ORDER BASED ON A KEY FIELD IN EACH       *
.*                ENTRY.                                              *
.*                                                                    *
.* DESCRIPTION    A BUBBLE SORT IS SORT IS PERFORMED.  THE KEYS       *
.*                OF CONSECUTIVE ITEMS ARE COMPARED.  THE ITEMS       *
.*                ARE SWITCHED IF NECESSARY.  PROCESSING PROCEEDS     *
.*                TO THE NEXT PAIR OF ENTRIES.  AT THE END OF ONE     *
.*                PASS, AT LEAST THE HIGHEST KEY IS IN THE PROPER     *
.*                POSITION.  THE LIST IS REDUCED TO A SUBLIST         *
.*                FROM THE FIRST ENTRY TO THE LAST ENTRY WHICH        *
.*                WAS SWITCHED AND THE SUBLIST IS THEN PROCESSED      *
.*                AS WAS THE ORIGINAL LIST.  THIS CONTINUES UNTIL     *
.*                THE ENTIRE LIST HAS BEEN SORTED.  IF AT ANY POINT,  *
.*                PROCESSING THE LIST RESULTS IN NO ENTRIES BEING     *
.*                SWITCHED, THE LIST IS IN ORDER AND PROCESSING       *
.*                IS TERMINATED.                                      *
.*                                                                    *
.*                REGISTERS 0, 1, 14, AND 15 ARE USED BY THE          *
.*                SORT AND MUST NOT BE SPECIFIED AS FIRST OR          *
.*                LAST VALUES.                                        *
.*                                                                    *
.* SYNTAX         NAME     #SORT FIELDS=(KEYPOS,KEYLEN,FMT,ORDER),    *
.*                               FIRST=SYMBOL1,                       *
.*                               LAST=SYMBOL2,                        *
.*                               LENGTH=NUM                           *
.*                                                                    *
.*                NAME   - SPECIFIES THE SYMBOLIC TAG TO BE           *
.*                         ASSIGNED TO THE FIRST INSTRUCTION          *
.*                         GENERATED.  THIS OPERAND IS OPTIONAL.      *
.*                                                                    *
.*                FIELDS - SPECIFIES THE SORT PARAMETERS.             *
.*                         KEYPOS - SPECIFIES THE RELATIVE KEY        *
.*                                  POSITION IN THE RECORD.           *
.*                         KEYLEN - SPECIFIES THE LENGTH OF THE KEY.  *
.*                         FMT    - SPECIFIES THE FORMAT OF THE       *
.*                                  DATA TO BE SORTED.  THE ONLY      *
.*                                  VALID FORMAT IS CHARACTER (CH).   *
.*                         ORDER  - SPECIFIES IF THE LIST IS TO BE    *
.*                                  SORTED IN ASCENDING ORDER (A),    *
.*                                  OR DESCENDING ORDER (D).  THE     *
.*                                  DEFAULT IS A.                     *
.*                                                                    *
.*                FIRST  - SPECIFIES THE SYMBOLIC NAME OF THE FIRST   *
.*                         ENTRY IN THE TABLE OR A REGISTER WHICH     *
.*                         CONTAINS THE ADDRESS OF THE FIRST ENTRY.   *
.*                         IF A SYMBOLIC NAME IS SPECIFIED, IT MUST   *
.*                         BE ADDRESSABLE.  IF A REGISTER IS          *
.*                         SPECIFIED, IT MUST BE ENCLOSED IN          *
.*                         PARENTHESES.  THIS PARAMETER IS REQUIRED.  *
.*                                                                    *
.*                LAST   - SPECIFIES THE SYMBOLIC NAME OF THE LAST    *
.*                         ENTRY IN THE TABLE OR A REGISTER WHICH     *
.*                         CONTAINS THE ADDRESS OF THE LAST ENTRY.    *
.*                         IF A SYMBOLIC NAME IS SPECIFIED, IT MUST   *
.*                         BE ADDRESSABLE.  IF A REGISTER IS          *
.*                         SPECIFIED, IT MUST BE ENCLOSED IN          *
.*                         PARENTHESES.  THIS PARAMETER IS REQUIRED.  *
.*                                                                    *
.*                LENGTH - SPECIFIES THE LENGTH OF THE ENTRIES IN     *
.*                         THE TABLE.  THIS PARAMETER IS REQUIRED.    *
.*                                                                    *
.*                                                                    *
.* ERRORS         INVALID NUMBER OF ENTRIES IN FIELDS PARAMETER - 8   *
.*                FORMAT TYPE NOT SUPPORTED                     - 8   *
.*                FIRST VALUE NOT SPECIFIED                     - 8   *
.*                LAST  VALUE NOT SPECIFIED                     - 8   *
.*                LENGTH VALUE NOT SPECIFIED                    - 8   *
.*                                                                    *
.* EXAMPLE        SORT A TABLE OF ENTRIES WHERE THE FIRST 8 BYTES     *
.*                ARE THE KEYS.  THE LENGTH OF EACH ENTRY IS 50       *
.*                BYTES.                                              *
.*                                                                    *
.*                         #SORT FIELDS=(1,8,CH,A),LENGTH=50,         *
.*                               FIRST=BEGIN,LAST=END                 *
.*                                                                    *
.*                BEGIN    DC    CL8'A',CL42'ENTRY 1'                 *
.*                         DC    CL8'D',CL42'ENTRY 2'                 *
.*                         DC    CL8'X',CL42'ENTRY 3'                 *
.*                         DC    CL8'$',CL42'ENTRY 4'                 *
.*                         DC    CL8'Q',CL42'ENTRY 5'                 *
.*                END      DC    CL8'M',CL42'ENTRY 6'                 *
.*                                                                    *
.* GLOBALS                                                            *
.*                                                                    *
.*                NONE                                                *
.*                                                                    *
.* MACROS USED                                                        *
.*                                                                    *
.*                NONE                                                *
.*                                                                    *
.**********************************************************************
.*
         LCLA  &X,&Y,&Z,&LEN
         LCLC  &HI,&I
.*
&I       SETC  '#SOR'.'&SYSNDX'(2,3)
&X       SETA  N'&FIELDS
         AIF   (&X NE 4).ERR1
         AIF   ('&FIELDS(3)' NE 'CH').ERR2
&HI      SETC  'H'
         AIF   ('&FIELDS(&X)' NE 'D').TESTA
&HI      SETC  'L'
         AGO   .SETREGS
.TESTA   AIF   ('&FIELDS(&X)' EQ 'A').SETREGS
         MNOTE *,'*** SORT TYPE NOT A OR D - A ASSUMED'
.SETREGS ANOP
&LEN     SETA  &LENGTH
&X       SETA  &FIELDS(1)-1            OFFSET WITHIN RECORD
&Y       SETA  &FIELDS(2)              LENGTH OF SORT-KEY
&Z       SETA  &X+&LEN                 OFFSET WITHIN NEXT RECORD
         AIF   ('&FIRST'  EQ '').ERR3
         AIF   ('&LAST'   EQ '').ERR4
         AIF   ('&LENGTH' EQ '').ERR5
.*
&NAME    LA    R0,&LENGTH              LOAD LENGTH OF AN ENTRY
         AIF   ('&LAST'(1,1) EQ '(').RFORM1
         LA    R1,&LAST                LOAD LAST ENTRY ADDRESS
         AGO   .CONT1
.RFORM1  LR    R1,&LAST                LOAD LAST ENTRY ADDRESS
.CONT1   ANOP
&I.A     SR    R14,R14                 CLEAR LAST SWITCH ADDRESS
         AIF   ('&FIRST'(1,1) EQ '(').RFORM2
         LA    R15,&FIRST              LOAD FIRST ENTRY ADDRESS
         AGO   .CONT2
.RFORM2  LR    R15,&FIRST              LOAD FIRST ENTRY ADDRESS
.CONT2   SR    R1,R0                   POINT TO PENULTIMATE
         CR    R15,R1                  TEST AGAINST FIRST ENTRY
         BH    &I.D                    IF HIGH, LIST SORTED
&I.B     CLC   &X.(&Y,R15),&Z.(R15)    COMPARE KEYS
         BN&HI &I.C
         XC    0(&LEN,R15),&LEN.(R15)  SWITCH ENTRIES
         XC    &LEN.(&LEN,R15),0(R15)
         XC    0(&LEN,R15),&LEN.(R15)
         LR    R14,R15                 SAVE ADDRESS OF SWITCHED ENTRY
&I.C     BXLE  R15,R0,&I.B             POINT TO NEXT ENTRY
         LTR   R1,R14                  COPY AND TEST LAST SWITCHED ADDR
         BNZ   &I.A
&I.D     EQU   *
         MEXIT
.ERR1    MNOTE 8,'INVALID NO. OF ENTRIES IN FIELDS PARAMETER'
         MEXIT
.ERR2    MNOTE 8,'FORMAT TYPE IS NOT SUPPORTED'
         MEXIT
.ERR3    MNOTE 8,'FIRST ENTRY ADDRESS NOT SPECIFIED.'
         MEXIT
.ERR4    MNOTE 8,'LAST  ENTRY ADDRESS NOT SPECIFIED.'
         MEXIT
.ERR5    MNOTE 8,'LENGTH NOT SPECIFIED.'
         MEND
         MACRO
&NAME    $RTRN &RC=0,&RENT=,&SP=1,&SPM=YES,&REST01=YES
         MNOTE *,'       $RTRN     VERSION 002 05/07/75  04/29/76  GPW'
.**********************************************************************
.*                                                                    *
.* $RTRN                                                              *
.*                                                                    *
.* FUNCTION       GENERATE CODE REQUIRED TO RETURN CONTROL TO THE     *
.*                CALLING PROGRAM.                                    *
.*                                                                    *
.* DESCRIPTION    STANDARD IBM LINKAGE CODE IS GENERATED BY THE MACRO *
.*                TO RETURN CONTROL TO THE CALLING PROGRAM.  THE USER *
.*                MAY SPECIFY THE RETURN CODE TO BE RETURNED.         *
.*                RE-ENTRANT CODE IS SUPPORTED.                       *
.*                                                                    *
.*                REGISTERS 0 THROUGH 14 (OR OPTIONALLY, REGISTERS    *
.*                2 THROUGH 14) WILL BE RESTORED TO THEIR STATUS      *
.*                UPON ENTRY TO THE ROUTINE.  REGISTER 15 WILL BE     *
.*                USED FOR A DEFAULT OR USER SPECIFIED RETURN CODE.   *
.*                AN X'FF' WILL BE PLACED IN THE HIGH ORDER BYTE OF   *
.*                WORD 4 OF THE OLD SAVE AREA TO INDICATE THAT        *
.*                CONTROL HAS BEEN RETURNED TO THE CALLING PROGRAM    *
.*                                                                    *
.*                CODE IS ALSO GENERATED TO RESTORE THE PROGRAM MASK  *
.*                TO ITS STATUS UPON ENTRY TO THE ROUTINE.  THE       *
.*                VALUE OF THE MASK IS OBTAINED FROM THE HIGH ORDER   *
.*                BYTE OF REGISTER 14.  THE ASSUMPTION IS MADE THAT   *
.*                STANDARD LINKAGE WAS USED TO INVOKE THE ROUTINE,    *
.*                THAT IS, THAT ENTRY WAS MADE BY A  BALR  R14,R15.   *
.*                IF THIS IS NOT TRUE, THE PROGRAM MASK WILL BE       *
.*                RESTORED INCORRECTLY.  IF SPM=NO IS SPECIFIED, THE  *
.*                PROGRAM MASK WILL NOT BE ALTERED.                   *
.*                                                                    *
.*                IF RE-ENTRANT CODE IS BEING GENERATED, A DROP R2    *
.*                STATEMENT IS GENERATED, SO THE USER SHOULD NOT USE  *
.*                REGISTER 2 AS A BASE REGISTER.                      *
.*                                                                    *
.* SYNTAX         NAME     $RTRN     RC=NUM1                          *
.*                                      (R15)                         *
.*                                   RENT=LEN                         *
.*                                   SP=NUM2                          *
.*                                   SPM=NO                           *
.*                                   REST01=NO                        *
.*                                                                    *
.*                NAME   - A SYMBOLIC TAG ASSIGNED TO THE FIRST       *
.*                         INSTRUCTION GENERATED.                     *
.*                                                                    *
.*                RC     - SPECIFIES THE RETURN CODE TO BE PLACED IN  *
.*                         REGISTER 15.  A NUMBER MAY BE SPECIFIED,   *
.*                         OR (R15) INDICATES THAT THE RETURN CODE    *
.*                         HAS ALREADY BEEN PLACED IN REGISTER 15 BY  *
.*                         THE USER.  THE DEFAULT RETURN CODE IS 0.   *
.*                                                                    *
.*                RENT   - INDICATES THAT THE WORK AREA OBTAINED BY   *
.*                         $ENTER IS TO BE FREED.  LEN SPECIFIES THE  *
.*                         LENGTH OF THE AREA.  THE ADDRESS IS        *
.*                         OBTAINED FROM REGISTER 13.                 *
.*                                                                    *
.*                SP     - SPECIFIES THE SUBPOOL OF THE WORK AREA.    *
.*                         IT MUST AGREE WITH THE SUBPOOL SPECIFIED   *
.*                         IN $ENTER.  THE DEFAULT IS 1.              *
.*                                                                    *
.*                SPM    - SPM=NO SPECIFIES THAT THE PROGRAM MASK     *
.*                         IS NOT TO BE ALTERED.                      *
.*                                                                    *
.*                REST01 - REST01=NO SPECIFIES THAT THE CONTENTS      *
.*                         OF REGISTERS 0 AND 1 ARE NOT TO BE         *
.*                         RESTORED.  THIS OPTION SHOULD BE           *
.*                         SPECIFIED WHEN DATA IS TO BE PASSED        *
.*                         BACK TO THE CALLING PROGRAM IN             *
.*                         REGISTERS 0 AND 1.                         *
.*                                                                    *
.* ERRORS         NO ERROR MESSAGES ARE GENERATED                     *
.*                                                                    *
.* EXAMPLE        EX1      $RTRN                                      *
.*                                                                    *
.*                EX2      $RTRN  RC=4                                *
.*                                                                    *
.*                EX3      $RTRN  RC=(R15),RENT=DSECTLEN              *
.*                                                                    *
.* GLOBAL SYMBOLS                                                     *
.*                                                                    *
.*                NONE                                                *
.*                                                                    *
.* MACROS CALLED                                                      *
.*                                                                    *
.*                FREEMAIN                                            *
.*                                                                    *
.* UPDATE SUMMARY                                                     *
.*                                                                    *
.*      VERSION   DATE     CHANGE                                     *
.*                                                                    *
.*        002   04/29/76   REST01 KEYWORD ADDED                       *
.*                                                                    *
.**********************************************************************
.*
         AIF   ('&RENT' EQ '').REGULAR
&NAME    LR    R1,R13                   LOAD STORAGE ADDRESS
         BALR  R2,0                     ESTABLISH BASE REG
         USING *,R2                     DEFINE BASE REGISTER
         L     R3,4(R13)                SAVE OLD SAVEAREA ADDR
         LR    R4,R15                   SAVE RETURN CODE
.FREE    MNOTE *,' FREEMAIN R,LV=&RENT,A=(1),SP=&SP'
         FREEMAIN R,LV=&RENT,A=(1),SP=&SP FREE STORAGE
* END FREEMAIN - $RTRN
         AIF   ('&RC' NE '(R15)').RESSAV
         LR    R15,R4                   RESTORE RETURN CODE
.RESSAV  LR    R13,R3                   RESTORE OLD SAVEAREA
         DROP  R2
         AGO   .COMMON
.REGULAR ANOP
&NAME    L     R13,4(R13)               RESTORE OLD SAVEAREA
.COMMON  AIF   ('&RC' EQ '(R15)').RES14
         LA    R15,&RC                  SET RETURN CODE
.RES14   L     R14,12(R13)              RESTORE RETURN ADDRESS
         AIF   ('&REST01' EQ 'NO').REST2
         LM    R0,R12,20(R13)           RESTORE REGS 0 - 12
         AGO   .SETFLAG
.REST2   LM    R2,R12,28(R13)           RESTORE REGS 2 - 12
.SETFLAG MVI   12(R13),X'FF'            SET RETURNED FLAG
.*-------TEST FOR SPM RESET
         AIF   ('&SPM' EQ 'NO').NOSPM
         SPM   R14                      RESTORE PROGRAM MASK
.NOSPM   BR    R14                      RETURN
         MEND
         MACRO
&NAME    $ENTER &BASE=R3,&CSECT=YES,&SAVE=,&RENT=,&SP=1,&SPM=YES,      +
               &CHAIN=YES
         MNOTE *,'       $ENTER    VERSION 003 05/07/75  04/29/76  GPW'
.**********************************************************************
.*                                                                    *
.* $ENTER                                                             *
.*                                                                    *
.* FUNCTION       PROVIDE ENTRY CODING TO ESTABLISH BASE REGISTERS,   *
.*                ALLOCATE AND CHAIN SAVE AREAS, SET PROGRAM MASK,    *
.*                AND OBTAIN WORK AREA FOR RE-ENTRANT PROGRAMS.       *
.*                                                                    *
.* DESCRIPTION    THE MACRO WILL GENERATE CODE TO ESTABLISH ONE OR    *
.*                MORE BASE REGISTERS.  IT IS ASSUMED THAT STANDARD   *
.*                IBM LINKAGE CONVENTIONS HAVE BEEN FOLLOWED AND THAT *
.*                REGISTER 15 CONTAINS THE ADDRESS OF THE ENTRY       *
.*                POINT.  USER SPECIFIED OR DEFAULT BASE REGISTERS    *
.*                ARE INITIALIZED.  THE FIRST BASE REGISTER CONTAINS  *
.*                THE ADDRESS OF THE ENTRY POINT, AND SUCCESSIVE BASE *
.*                REGISTER ADDRESSES ARE INCREMENTED BY 4096.  THE    *
.*                DEFAULT BASE REGISTER IS REGISTER 3.  IF REGISTER 2 *
.*                IS SPECIFIED AS A BASE REGISTER, IT WILL BE         *
.*                ALLOWED, BUT A WARNING MESSAGE WILL BE DISPLAYED.   *
.*                REGISTERS 0, 1, 13, 14, AND 15 MAY NOT BE           *
.*                SPECIFIED AS BASE REGISTERS.  ALL REGISTER          *
.*                SPECIFICATIONS MUST BE MADE AS MNEMONICS (EG,       *
.*                REGISTER 3 IS R3).                                  *
.*                                                                    *
.*                IDENTIFICATION CONSTANTS SPECIFYING THE DATE AND    *
.*                TIME OF ASSEMBLY ARE CONSTRUCTED IN THE ENTRY       *
.*                CODING.  THESE VALUES ARE DISPLAYED IN DUMPS AND    *
.*                MAY BE USED TO VERIFY THAT THE PROPER VERSION OF    *
.*                THE ROUTINE HAS BEEN USED.                          *
.*                                                                    *
.*                ALL BITS OF THE PROGRAM MASK ARE SET.  IBM          *
.*                TRANSFERS CONTROL TO THE USER PROGRAM WITH ALL      *
.*                PROGRAM MASK BITS OFF.  IF SPM=NO IS SPECIFIED,     *
.*                THE PROGRAM MASK WILL BE UNALTERED.                 *
.*                                                                    *
.*                THE USER MAY SPECIFY THE NAME OF A WORK AREA OF 18  *
.*                FULLWORDS TO BE USED AS A SAVE AREA.  IF A USER     *
.*                AREA IS NOT SUPPLIED, AN 18 FULLWORD AREA IS        *
.*                ALLOCATED AND INITIALIZED TO ZERO.  THE ADDRESS OF  *
.*                THE SAVE AREA IS LOADED INTO REGISTER 13 AND IT IS  *
.*                CHAINED TO THE SAVE AREA OF THE CALLING PROGRAM.    *
.*                                                                    *
.*                THE USER MAY SPECIFY THAT THE MACRO IS NOT TO       *
.*                OBTAIN A SAVE AREA OR CHAIN SAVE AREAS BY           *
.*                SPECIFYING CHAIN=NO.  THE USER IS THEN              *
.*                RESPONSIBLE FOR SAVE AREA CHAINING.                 *
.*                                                                    *
.*                REGISTER EQUIVALENCES (R0  EQU  0, ETC.) ARE        *
.*                GENERATED FOR THE FIRST USAGE OF THE MACRO.         *
.*                                                                    *
.*                A CSECT DEFINITION WILL BE GENERATED UNLESS         *
.*                CSECT=NO IS SPECIFIED.  IF CSECT=NO IS SPECIFIED,   *
.*                AN ENTRY STATEMENT WILL BE GENERATED.               *
.*                                                                    *
.*                RE-ENTRANT CODING IS SUPPORTED.  FOR RE-ENTRANT     *
.*                CODING, THE USER MUST SPECIFY THE LENGTH OF A       *
.*                WORK AREA.  THE WORK AREA IS OBTAINED FROM SUBPOOL  *
.*                1 UNLESS OTHERWISE SPECIFIED.  THE FIRST 18 WORDS   *
.*                OF THE WORK AREA ARE USED FOR THE SAVE AREA.        *
.*                                                                    *
.* SYNTAX         NAME     $ENTER    BASE=(REG1,...,REGN)             *
.*                                   CSECT=NO                         *
.*                                   SAVE=SYM                         *
.*                                   RENT=LEN                         *
.*                                   SP=NUMBER                        *
.*                                   SPM=NO                           *
.*                                   CHAIN=NO                         *
.*                                                                    *
.*                NAME   - A SYMBOLIC TAG ASSIGNED TO THE FIRST       *
.*                         INSTRUCTION GENERATED.                     *
.*                                                                    *
.*                BASE   - THE REGISTERS TO BE USED AS BASE           *
.*                         REGISTERS.  THE DEFAULT IS R3.  THE FIRST  *
.*                         REGISTER SPECIFIED WILL CONTAIN THE        *
.*                         ADDRESS OF THE ENTRY POINT, AND SUCCEEDING *
.*                         BASE VALUES WILL BE INCREMENTED BY 4096.   *
.*                         REGISTERS 0, 1, 13, 14, AND 15 MAY NOT BE  *
.*                         SPECIFIED AS BASE REGISTERS.  REGISTERS    *
.*                         MUST BE SPECIFIED IN MNEMONIC FORM (EG,    *
.*                         R3 FOR REGISTER 3).                        *
.*                                                                    *
.*                CSECT  - CSECT=NO SPECIFIES THAT CODING FOR AN      *
.*                         ENTRY POINT RATHER THAN A CSECT IS TO BE   *
.*                         GENERATED.                                 *
.*                                                                    *
.*                SAVE   - SPECIFIES THE NAME OF A USER DEFINED 18    *
.*                         WORD SAVE AREA TO BE USED INSTEAD OF       *
.*                         GENERATING AN IN-LINE SAVE AREA.  IF RENT  *
.*                         IS SPECIFIED, SAVE MUST SPECIFY THE NAME   *
.*                         ASSIGNED TO THE FIRST 18 WORDS IN THE      *
.*                         WORK AREA.                                 *
.*                                                                    *
.*                RENT   - SPECIFIES THAT RE-ENTRANT CODE IS TO BE    *
.*                         GENERATED.  LEN IS THE LENGTH OF A WORK    *
.*                         AREA TO BE OBTAINED BY A GETMAIN.          *
.*                                                                    *
.*                SP     - SPECIFIES THE SUBPOOL FROM WHICH THE WORK  *
.*                         AREA FOR RE-ENTRANT CODING IS TO BE        *
.*                         OBTAINED.  DEFAULT IS SUBPOOL 1.           *
.*                                                                    *
.*                SPM    - SPM=NO SPECIFIES THAT THE PROGRAM MASK IS  *
.*                         NO TO BE ALTERED.                          *
.*                                                                    *
.*                CHAIN  - CHAIN=NO SPECIFIES THAT SAVE AREA ARE NOT  *
.*                         TO BE CHAINED.  THIS OPTION IS INTENDED    *
.*                         FOR USE ONLY BY HIGH ACTIVITY RE-ENTRANT   *
.*                         MODULES WHERE THE OVERHEAD OF              *
.*                         GETMAIN/FREEMAIN IS TO BE AVOIDED.         *
.*                                                                    *
.* ERRORS         THE NAME FIELD MUST BE SPECIFIED.  IF IT IS NOT, A  *
.*                GENERATED NAME, $ENTNNNN WILL BE GENERATED AND A    *
.*                SEVERITY 8 MNOTE IS GENERATED.  IF NO CODE WERE     *
.*                GENERATED AND NO BASE REGISTER DEFINED, THE ERROR   *
.*                LISTING WOULD BE LARGE.  TO REDUCE THE SIZE OF THE  *
.*                ERROR LISTING AND ALLOW OTHER ERRORS TO BE FOUND,   *
.*                THE MACRO WILL EXPAND.                              *
.*                                                                    *
.*                                                                    *
.* EXAMPLE        EX1      $ENTER                                     *
.*                                                                    *
.*                EX2      $ENTER CSECT=NO                            *
.*                                                                    *
.*                EX3      $ENTER BASE=(R3,R4,R5)                     *
.*                                                                    *
.*                EX4      $ENTER BASE=R12,RENT=DSECTLEN,SAVE=SAVEAREA*
.*                                                                    *
.* GLOBAL SYMBOLS                                                     *
.*                                                                    *
.*                NAME     TYPE  USE                                  *
.*                                                                    *
.*                &ENCOUNT   A   SET TO 1 AFTER REGISTER EQUIVALENCES *
.*                               GENERATED TO PREVENT EQUIVALENCES    *
.*                               FROM BEING GENERATED FOR LATER USES. *
.*                                                                    *
.* MACROS USED                                                        *
.*                                                                    *
.*                GETMAIN                                             *
.*                                                                    *
.* UPDATE SUMMARY                                                     *
.*                                                                    *
.*      VERSION   DATE     CHANGE                                     *
.*                                                                    *
.*        003   04/29/76   CHAIN KEYWORD ADDED                        *
.*                                                                    *
.*                                                                    *
.**********************************************************************
.*
         GBLA  &ENCOUNT
.*
         LCLA  &PARMNO,&REGNO
         LCLC  &REG,&CHAR,&LAST,&USING,&TEMP,&ID,&FIRST
.*
&ID      SETC  '&NAME'
         AIF   ('&NAME' NE '').CKCSECT
&ID      SETC  '$ENT&SYSNDX'
         MNOTE 8,'NAME OPERAND REQUIRED, NOT SPECIFIED. &ID WILL BE USE+
               D.'
.CKCSECT AIF   ('&CSECT' NE 'NO').CSECT
         AIF   ('&SYSECT' NE '').CKEQU
         MNOTE 8,'ENTRY POINT SPECIFIED, BUT NO CSECT DEFINED'
.CSECT   ANOP
         SPACE
&ID      CSECT
.CKEQU   AIF   (&ENCOUNT EQ 1).SKIPEQU
         SPACE
***********************************************************************
*                                                                     *
*                      REGISTER EQUIVALENCES                          *
*                                                                     *
***********************************************************************
         SPACE
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
.*
&ENCOUNT SETA  1
         SPACE
.SKIPEQU AIF   ('&CSECT' NE 'NO').CSECT2
         AIF   ('&SYSECT' EQ '').CSECT2
.*-------ENTRY POINT
         ENTRY &ID
         USING &ID,R15                  DEFINE BASE REGISTER
&ID      B     14(R15)                  BRANCH AROUND ID
         DC    AL1(8)                   IDENTIFIER LENGTH
         DC    CL8'&ID'                 ENTRY POINT NAME
         DC    CL1' '                   SPACER
         AGO   .STREGS
.*-------CSECT
.CSECT2  USING &ID,R15                  DEFINE BASE REGISTER
         B     28(0,R15)                BRANCH AROUND ID
         DC    AL1(23)                  IDENTIFIER LENGTH
         DC    CL8'&ID'                 CSECT NAME
         DC    CL1' '                   SPACER
         DC    CL8'&SYSDATE'            DATE OF ASSEMBLY
         DC    CL1' '                   SPACER
         DC    CL5'&SYSTIME'            TIME OF ASSEMBLY
.STREGS  STM   R14,R12,12(R13)          SAVE REGISTERS
&PARMNO  SETA  1                        INITIALIZE COUNTER
.CKBASE  ANOP
&REG     SETC  '&BASE(&PARMNO)'(1,3)
         AIF   ('&REG'(1,1) NE 'R').SKIPBAS
&TEMP    SETC  '&REG'(2,2)
&REGNO   SETA  &TEMP
         AIF   (&REGNO LT 2).BADBASE
         AIF   (&REGNO GT 12).BADBASE
         AIF   (&REGNO NE 2).SETBASE
         MNOTE 0,'*** WARNING - R2 IS A BASE REGISTER. TRANSLATE AND TE+
               ST INSTRUCTION WILL DESTROY CONTENTS.'
.SETBASE ANOP
         AIF   ('&FIRST' NE '').SETBAS2
         LR    &REG,R15                 LOAD BASE ADDRESS
&FIRST   SETC  '&REG'                   SAVE REGISTER
         AGO   .SETLAST
.SETBAS2 LA    &REG,4095(&LAST)         ADD 4095 TO LAST BASE
         LA    &REG,1(&REG)             ADD 1 MORE
.SETLAST ANOP
&LAST    SETC  '&REG'
&USING   SETC  '&USING.,&REG'
         AGO   .NEXTBAS
.SKIPBAS MNOTE 8,'*&REG* IS AN INVALID REGISTER FORM, IGNORED'
         AGO   .NEXTBAS
.BADBASE MNOTE 8,'*&REG* IS AN INVALID BASE REGISTER, IGNORED'
.NEXTBAS ANOP
&PARMNO  SETA  &PARMNO+1
         AIF   (&PARMNO LE N'&BASE).CKBASE
         DROP  R15                      DISCONTINUE R15 BASE
         USING &ID.&USING               DEFINE BASE REGISTERS
.*-------SEE IF PROGRAM MASK IS TO BE SET
         AIF   ('&SPM' EQ 'NO').NOSPM
         LA    R15,15                   LOAD PGM MASK SETTING
         SLA   R15,24                   SHIFT TO BITS 4-7
         SPM   R15                      SET PGM MASK AND COND
.NOSPM   AIF   ('&CHAIN' EQ 'NO').DONE
         AIF   ('&RENT' NE '').GETMAIN
         LR    R15,R13                  SAVE OLD SAVEAREA ADDR
         AIF   ('&SAVE' NE '').LOADSAV
         CNOP  0,4                      FULL WORD ALIGNMENT
         BAL   R13,*+76                 LOAD SAVEAREA ADDR
         DC    18F'0'                   SAVE AREA
         AGO   .CHAIN
.LOADSAV LA    R13,&SAVE                LOAD NEW SAVEAREA ADDR
         AGO   .CHAIN
.GETMAIN MNOTE *,' GETMAIN R,LV=&RENT,SP=&SP'
         GETMAIN R,LV=&RENT,SP=&SP      GET STORAGE
* END OF GETMAIN - $ENTER
         LR    R15,R13                  SAVE OLD SAVEAREA ADDR
         LR    R13,R1                   LOAD STORAGE ADDRESS
         USING &SAVE,R13                DEFINE BASE REGISTER
         L     R1,24(R15)               RESTORE REG 1 CONTENTS
.CHAIN   ST    R15,4(R13)               CHAIN SAVE AREAS
         ST    R13,8(R15)
.DONE    ANOP
         MEND
***********************************************************************
*                                                                     *
* INSTALLATION INSTRUCTIONS                                           *
*                                                                     *
*     THIS MODULE MAY BE ASSEMBLED AND LINKED INTO A LIBRARY IN THE   *
*     LINK LIST OR SPECIFIED AS A STEPLIB IN THE EXECUTION JCL.       *
*                                                                     *
*     BEFORE ASSEMBLING THE MODULE, INSURE THAT ALL THE REQUIRED      *
*     MACROS ARE AVAILABLE.  SOME MACROS FROM SYS1.AMODGEN MAY BE     *
*     REQUIRED.  THE $ENTER MACRO USES SYSTEM VARIABLE SYMBOLS        *
*     &SYSDATE AND &SYSTIME.  THESE SYMBOLS ARE NOT SUPPORTED BY ALL  *
*     ASSEMBLERS.  IF THE ASSEMBLER TO BE USED DOES NOT SUPPORT THESE *
*     SYMBOLS, THE $ENTER MACRO MUST BE MODIFIED.                     *
*                                                                     *
***********************************************************************
SS0127   TITLE 'CATALOG/VTOC COMPARISON PROGRAM'
***********************************************************************
*                                                                     *
* NAME         VOLCHECK                                               *
*                                                                     *
* FUNCTION     THIS PROGRAM WILL READ THE VOLUME TABLE OF CONTENTS    *
*              (VTOC) OF UP TO 99 DIRECT ACCESS VOLUMES TO OBTAIN     *
*              THE DATA SET NAME OF EACH DATA SET ON THE VOLUME.      *
*              THE CATALOG ENTRY FOR EACH DATA SET WILL BE READ TO    *
*              DETERMINE IF THE DATA SET IS CATALOGED, AND IF THE     *
*              CATALOG INFORMATION IS CORRECT.                        *
*                                                                     *
* ENVIRONMENT  OS/VS2                                                 *
*              OS/MVT                                                 *
*              BACKGROUND                                             *
*                                                                     *
* DESCRIPTION  THE VTOC IS OPENED AS A SEQUENTIAL DATA SET AND READ   *
*              USING BSAM.  THE PROGRAM MUST SUPPLY THE VTOC DSNAME   *
*              BY READING AND MODIFYING THE JFCB AND PERFORMING AN    *
*              OPEN TYPE=J.  EVERY ENTRY WHICH IS NOT A FORMAT 1      *
*              DSCB IS IGNORED.  THE DSNAME IS OBTAINED FROM THE      *
*              FORMAT 1 DSCB AND A LOCATE BY NAME IS ISSUED.  IF THE  *
*              RETURN CODE IS NOT ZERO, THE DATA SET IS NOT CATALOGED *
*              AND A MESSAGE IS ISSUED.                               *
*                                                                     *
*              IF THE RETURN CODE IS ZERO, THE VOLUME LIST RETURNED   *
*              BY LOCATE IS SEARCHED TO BE SURE THAT THE LIST         *
*              CONTAINS THE VOLUME SERIAL OF THE VOLUME BEING         *
*              PROCESSED.  IF NOT, A MESSAGE IS ISSUED.               *
*                                                                     *
*              IF BOTH TESTS ARE MET, THE NEXT ENTRY IS PROCESSED.    *
*              THIS CONTINUES UNTIL THE END OF DATA IS REACHED.       *
*                                                                     *
*              VSAM DATA SETS ARE IGNORED.                            *
*                                                                     *
* INPUT        THE INPUT CONSISTS OF A VTOC OF A VOLUME (DEFINED BY   *
*              A DD STATEMENT), AND THE CATALOG (NO DD STATEMENT      *
*              REQUIRED).                                             *
*                                                                     *
* OUTPUT       OUTPUT CONSISTS OF -                                   *
*                   1.  A PRINTED REPORT LISTING THE DATA SETS ON THE *
*                       VOLUME WHICH HAVE NO CATALOG ENTRIES, OR FOR  *
*                       WHICH THE CATALOG ENTRY DOES NOT POINT TO THE *
*                       VOLUME.                                       *
*                                                                     *
*                   2.  A FILE OF IEHPROGM SCRATCH STATEMENTS FOR     *
*                       EACH UNCATALOGED OR MISCATALOGED DATA SET.    *
*                                                                     *
* PARAMETERS   NONE.                                                  *
*                                                                     *
* EXECUTION    EXEC         SPECIFIES THE PROGRAM NAME.  NO PARM      *
*                           INFORMATION IS SPECIFIED.                 *
*                                                                     *
*              SYSPRINT DD  DEFINES THE OUTPUT MESSAGE DATA SET.      *
*                                                                     *
*              SYSUT2   DD  DEFINES THE OUTPUT IEHPROGM STATEMENTS.   *
*                                                                     *
*              VOLUMENN DD  DEFINES THE VOLUMES TO BE PROCESSED.      *
*                           VOLUME01 FOR THE FIRST VOLUME,            *
*                           VOLUME02 FOR THE SECOND VOLUME, ETC.      *
*                                                                     *
* EXAMPLE      LIST THE UNCATALOGED AND IMPROPERLY CATALOGED DATA     *
*              SETS ON WK1101 AND WK1102.                             *
*                                                                     *
*              //LIST   EXEC  PGM=VOLCHECK                            *
*              //SYSPRINT DD  SYSOUT=A                                *
*              //SYSUT2   DD  SYSOUT=B                                *
*              //VOLUME01 DD  DISP=OLD,UNIT=DISK,VOL=SER=WK1101       *
*              //VOLUME02 DD  DISP=OLD,UNIT=DISK,VOL=SER=WK1102       *
*                                                                     *
* RETURN CODES                                                        *
*               0 - SUCCESSFUL COMPLETION                             *
*               4 - NOT USED                                          *
*               8 - NOT USED                                          *
*              12 - NOT USED                                          *
*              16 - UNABLE TO OPEN SYSUT2, NO OUTPUT PRODUCED         *
*                                                                     *
* ABEND CODES  USER 0001 - UNABLE TO OPEN SYSPRINT, NO OUTPUT         *
*                          PRODUCED.                                  *
*                                                                     *
* FPL MACROS USED -                                                   *
*                                                                     *
*              $ENTER    $RTRN                                        *
*              #SORT                                                  *
*              #VTCFMT1  #VTCFMT3  #VTCFMT4                           *
*                                                                     *
* IBM MACROS USED -                                                   *
*                                                                     *
*              OPEN      CLOSE     DCB       DCBD                     *
*              READ      CHECK     PUT                                *
*              RDJFCB    IEFJFCBN                                     *
*              LOCATE    OBTAIN    CAMLST                             *
*              GETMAIN   FREEMAIN                                     *
*              ABEND                                                  *
*              LINK                                                   *
*                                                 9/76 GORDON P. WEST *
***********************************************************************
         SPACE 2
***********************************************************************
*                                                                     *
* UPDATE LOG                                                          *
*                                                                     *
* 03/07/78  CORRECTED ERROR WHEN OVER 200 UNCATALOGED OR MISCATALOGED *
*                DATA SETS FOUND                                      *
*           ADDED 3350 TO DEVICE TABLE                                *
*           ADDED 3380 TO DEVICE TABLE                                *
*                                                                     *
***********************************************************************
         EJECT
SS0127   $ENTER BASE=(R12,R11)         ENTRY CODING
         OPEN  (SYSPRINT,OUTPUT)       OPEN SYSPRINT
         TM    SYSPRINT+48,X'10'       TEST FOR SUCCESSFUL OPEN
         BNZ   OPEN1OK
         ABEND 0001                    OPEN FAILED, ABEND
OPEN1OK  OPEN  (SYSUT2,OUTPUT)         OPEN SYSUT2
         TM    SYSUT2+48,X'10'         TEST FOR SUCCESSFUL SYSUT2 OPEN
         BNZ   OPEN2OK
         PUT   SYSPRINT,ERROR8
         MVI   CCODE+3,16              SET CONDITION CODE
         B     RETURN
         EJECT
***********************************************************************
*                                                                     *
*        GET STORAGE FOR OUTPUT LINES                                 *
*                                                                     *
***********************************************************************
         SPACE 2
OPEN2OK  GETMAIN R,LV=26600,SP=1       STORAGE FOR 200 133 CHAR LINES
         ST    R1,TABLEADR             SAVE TABLE ADDRESS
         OI    SWITCH,X'02'            INDICATE FREEMAIN REQUIRED
         EJECT
***********************************************************************
*                                                                     *
*        PUT DATE AND TIME IN HEADER LINE                             *
*                                                                     *
***********************************************************************
         SPACE 2
         TIME  DEC                     GET DATE AND TIME
         BAL   R5,DATECON1             CONVERT DATE TO EBCDIC
         MVC   HDRDATE,PDEC            COPY DATE TO HEADER
         LR    R1,R0                   PROCESS TIME
         SRL   R1,8                    GET RID OF LOW ORDER BITS
         SLL   R1,4
         ST    R1,PDEC
         ED    TIME,PDEC               EDIT TIME
         EJECT
***********************************************************************
*                                                                     *
*        OPEN VTOC AND READ FORMAT 4 DSCB                             *
*                                                                     *
***********************************************************************
         SPACE 2
READJFCB AP    COUNTER,=P'1'           INCREMENT COUNTER
         CP    COUNTER,=P'99'          TEST FOR MAXIMUM
         BH    RETURN
         L     R1,TABLEADR             LOAD TABLE ADDRESS
         LA    R2,133                  LOAD LENGTH OF AN ENTRY
         L     R3,=F'26600'            LOAD LENGTH OF TABLE
         SR    R3,R2                   SUBRACT LENGTH OF ONE ENTRY
         AR    R3,R1                   ADD TABLE ADDRESS
         SR    R1,R2                   SUBTRACT LENGTH FROM TABLE ADDR
         STM   R1,R3,SAVE              SAVE
         UNPK  SYSUT1+46(2),COUNTER    PUT NUMBER IN DDNAME
         OI    SYSUT1+47,X'F0'         SET ZONE TO F
         RDJFCB SYSUT1                 READ SYSUT1 JFCB
         MVC   JFCBDSNM,VTOCDSNM       SET VTOC DSNAME
         MVC   VOLSER,JFCBVOLS         SAVE VOLUME SERIAL
         DEVTYPE SYSUT1+40,DEVCODE     GET DEVICE CODE
         OPEN  SYSUT1,TYPE=J           OPEN VTOC
         TM    SYSUT1+48,X'10'         TEST FOR SUCCESSFUL OPEN
         BZ    RETURN
         PUT   SYSPRINT,HEADER         PRINT HEADER LINE
*--------READ FORMAT 4 DSCB
         READ  DECB4,SF,SYSUT1,FMT1DSCB,'S'      READ FORMAT 4 DSCB
         CHECK DECB4                   WAIT UNTIL READ COMPLETE
         MVC   TRKPRCYL,DS4DEVSZ+2     SAVE TRACKS PER CYLINDER
         SR    R9,R9                   CLEAR TOTAL TRACKS ALLOCATED
         NI    SWITCH,X'FF'-X'01'      RESET INDICATOR
         SR    R2,R2                   CLEAR R2
         IC    R2,DEVCODE+3            LOAD DEVICE CODE
         SLA   R2,3                    MULTIPLY BY 8
         LA    R2,DEVTABLE(R2)         LOAD TABLE ADDRESS
         SR    R15,R15
         IC    R15,0(R2)               INSERT DEVICE NAME LENGTH
         LTR   R15,R15                 TEST NAME LENGTH
         BNZ   BLANKOUT
         PUT   SYSPRINT,WARN           PRINT WARNING MESSAGE
         LA    R15,5                   SET LENGTH FOR SYSDA
BLANKOUT MVC   SCRATCHV(14),=CL14' '   BLANK OUT DEVICE CODE & SERIAL
         MVC   SCRATCHV(7),1(R2)       MOVE IN DEVICE NAME
         LA    R1,SCRATCHV(R15)        LOAD ADDRESS FOR SERIAL
         MVC   1(6,R1),VOLSER          COPY SERIAL TO SCRATCH RECORD
FINDBLNK LA    R1,1(R1)
         CLI   0(R1),C' '
         BNE   FINDBLNK
         MVI   0(R1),C','
         EJECT
***********************************************************************
*                                                                     *
*        READ VTOC RECORDS AND COMPARE TO CATALOG                     *
*                                                                     *
***********************************************************************
         SPACE 2
READVTOC READ  RDECB,SF,SYSUT1,FMT1DSCB,'S'      READ A VTOC RECORD
         CHECK RDECB                   WAIT UNTIL READ COMPLETE
         CLI   DS1FMTID,C'1'           TEST FOR FORMAT 1 DSCB
         BNE   READVTOC
         TM    DS1DSORG+1,X'08'        TEST FOR VSAM DATA SET
         BNZ   READVTOC
         MVC   DSNAME,DS1DSNAM         COPY DSNAME FOR LOCATE (LOCATE
*                                           WILL CHANGE ALIAS NAME TO
*                                           TRUE NAME).
         LOCATE LOCLIST                READ CATALOG ENTRY
         LTR   R15,R15                 TEST RETURN CODE
         BNZ   NOTCTLGD
         LA    R8,CATBLOCK             LOAD CATALOG BLOCK ADDRESS
         LH    R1,0(R8)                LOAD VOLUME COUNT
         LA    R8,2(R8)                POINT TO FIRST VOLUME ENTRY
         C     R1,=F'20'               TEST VOL COUNT AGAINST VS MAX
         BNH   GETSER
         LA    R1,20                   SET VOLUME COUNT TO 20
GETSER   CLC   VOLSER,4(R8)            TEST VOL SER IN CAT TO THIS VOL
         BE    READVTOC
         LA    R8,12(R8)               INCREMENT TO NEXT VOLUME ENTRY
         BCT   R1,GETSER               DECREMENT COUNT AND LOOP
         EJECT
***********************************************************************
*                                                                     *
*        CATALOG DOES NOT POINT TO THIS VOLUME                        *
*                                                                     *
***********************************************************************
         SPACE 2
         MVC   DSN2,DS1DSNAM           INCORRECT CAT ENTRY, COPY DSNAME
         MVC   SER2,VOLSER             COPY VOLUME SERIAL TO MESSAGE
         LA    R2,ALLOC2               LOAD OUTPUT AREA ADDRESS
         MVC   0(14,R2),=CL14' '       BLANK OUT OUTPUT AREA
         BAL   R14,$ALLOC              GET ALLOCATION INFORMATION
         AR    R9,R6                   ACCUMULATE TRACKS ALLOCATED
         LA    R2,CRDATE2              LOAD OUTPUT AREA ADDRESS
         MVC   0(14,R2),=CL14' '       BLANK OUT OUTPUT AREA
         BAL   R14,$CRDATE             GET CREATION DATE
         LM    R1,R3,SAVE              LOAD POINTERS
         BXH   R1,R2,OVERFLOW          INCREMENT POINTERS
         MVC   0(133,R1),ERROR2        MOVE LINE INTO STORAGE
         STM   R1,R3,SAVE              SAVE POINTERS
         OI    SWITCH,X'01'            INDICATE OUTPUT PRODUCED
         B     READVTOC                GET ANOTHER ENTRY
         EJECT
***********************************************************************
*                                                                     *
*        DATA SET IS NOT CATALOGED                                    *
*                                                                     *
***********************************************************************
         SPACE 2
NOTCTLGD MVC   DSN3,DS1DSNAM           NOT CATALOGED, COPY DSNAME
         LA    R2,ALLOC3               LOAD OUTPUT AREA ADDRESS
         MVC   0(14,R2),=CL14' '       BLANK OUT OUTPUT AREA
         BAL   R14,$ALLOC              GET ALLOCATION INFORMATION
         AR    R9,R6                   ACCUMULATE TRACKS ALLOCATED
         LA    R2,CRDATE3              LOAD OUTPUT AREA ADDRESS
         MVC   0(14,R2),=CL14' '       BLANK OUT OUTPUT AREA
         BAL   R14,$CRDATE             GET CREATION DATE
         LM    R1,R3,SAVE              LOAD POINTERS
         BXH   R1,R2,OVERFLOW          INCREMENT POINTER
         MVC   0(133,R1),ERROR3        MOVE LINE INTO STORAGE
         STM   R1,R3,SAVE              SAVE POINTERS
         OI    SWITCH,X'01'            INDICATE OUTPUT PRODUCED
         B     READVTOC                GET ANOTHER ENTRY
         EJECT
***********************************************************************
*                                                                     *
*        GET ALLOCATION  (ALLOCATED, USED, AND EXTENTS)               *
*                                                                     *
***********************************************************************
*                                                                     *
*        R2        - OUTPUT AREA ADDRESS                              *
*        R3        - RESERVED (DSNAME PDE POINTER)                    *
*        R4        - NUMBER OF EXTENTS (COUNTER)                      *
*        R5        - EXECUTE TABLE POINTER                            *
*        R6        - TRACKS ALLOCATED                                 *
*        R7        - EXTENT DESCRIPTION POINTER/TRACKS USED           *
*        R8 - R13  - RESERVED (POINTERS AND BASE REGISTERS)           *
*                                                                     *
***********************************************************************
         SPACE 2
$ALLOC   CLC   DS1PTRDS,=XL5'00'       SEE IF FORMAT 3 DSCB IS NEEDED
         BE    PROCESS
         OBTAIN OBTAIN                 READ FORMAT 3 DSCB
         LTR   R15,R15                 TEST RETURN CODE
         BZ    PROCESS
         MVC   DSN7,DS1DSNAM           MOVE DSNAME INTO MESSAGE
         PUT   SYSPRINT,ERROR7         DISPLAY ERROR MESSAGE
         MVI   CCODE+3,16              SET CONDITION CODE
         B     CLOSEUT1
*--------GET TRACK ALLOCATION
PROCESS  SR    R4,R4                   CLEAR REGISTER 4
         SR    R5,R5                   CLEAR REGISTER 5
         SR    R6,R6                   CLEAR REGISTER 6
         SR    R7,R7                   CLEAR REGISTER 7
         IC    R4,DS1NOPEV             LOAD NUMBER OF EXTENTS
         LTR   R4,R4                   TEST NUMBER OF EXTENTS
         BZ    ALLOCEND
DSATTRKS EX    R0,DSATADDR(R5)         PROCESS EXTENT BLOCK
         CLI   0(R7),X'00'
         BE    DSATUTRK
         LA    R7,2(R7)                LOAD ADDRESS OF STARTING TRACK
         MVC   HALF(2),4(R7)           LOAD ENDING CYL NUMBER
         LH    R1,HALF
         MVC   HALF(2),0(R7)           LOAD STARTING CYL NUMBER
         SH    R1,HALF                 SUBTRACT STARTING FROM ENDING
         MH    R1,TRKPRCYL             MULTIPLY BY TRACKS PER CYL
         MVC   HALF(2),6(R7)           LOAD ENDING TRACK
         AH    R1,HALF                 ADD TO TRACK COUNT
         MVC   HALF(2),2(R7)           LOAD STARTING TRACK
         SH    R1,HALF                 SUBTRACT FROM TRACK COUNT
         AR    R6,R1                   ACCUMULATE TOTAL
         LA    R6,R1(R6)               ADD 1 TRACK
         LA    R5,4(R5)
         BCT   R4,DSATTRKS             DECREMENT EXTENT COUNT
DSATUTRK CVD   R6,PDEC                 CONVERT TRACKS TO DECIMAL
         MVC   DEC,=X'4020202020202120'      MOVE MASK
         ED    DEC,PDEC+4              EDIT
         MVC   0(5,R2),DEC+3           MOVE INTO MESSAGE
*--------GET TRACKS USED
         LH    R7,DS1LSTAR             LOAD TRACKS USED
         CLC   DS1LSTAR,=X'000000'
         BE    DSATXNTS
         LA    R7,1(R7)                ADD 1
         CVD   R7,PDEC                 CONVERT TO DECIMAL
         MVC   DEC,=X'4020202020202120'  MOVE MASK
         ED    DEC,PDEC+4              EDIT
         MVC   6(5,R2),DEC+3           MOVE INTO MESSAGE
*--------GET NUMBER OF EXTENTS
DSATXNTS SR    R1,R1
         IC    R1,DS1NOPEV             LOAD EXTENTS
         CVD   R1,PDEC                 CONVERT TO DECIMAL
         MVC   DEC,=X'4020202020202120'  MOVE MASK
         ED    DEC,PDEC+4              EDIT
         MVC   12(2,R2),DEC+6          MOVE INTO MESSAGE
ALLOCEND BR    R14                     RETURN
         EJECT
*--------DSCB'S
DSATADDR LA    R7,DS1EXT1
         LA    R7,DS1EXT2
         LA    R7,DS1EXT3
         LA    R7,DS3EXT01
         LA    R7,DS3EXT02
         LA    R7,DS3EXT03
         LA    R7,DS3EXT04
         LA    R7,DS3EXT05
         LA    R7,DS3EXT06
         LA    R7,DS3EXT07
         LA    R7,DS3EXT08
         LA    R7,DS3EXT09
         LA    R7,DS3EXT10
         LA    R7,DS3EXT11
         LA    R7,DS3EXT12
         LA    R7,DS3EXT13
         EJECT
***********************************************************************
*                                                                     *
*        CREATION DATE                                                *
*                                                                     *
***********************************************************************
         SPACE 2
$CRDATE  L     R1,DS1CREDT-1           LOAD CREATION DATE
         BAL   R5,DATECONV             CONVERT IT
         MVC   0(8,R2),PDEC            MOVE DATE INTO MESSAGE
         BR    R14                     RETURN
         EJECT
***********************************************************************
*                                                                     *
*        DATE CONVERSION ROUTINE                                      *
*                                                                     *
*             THIS SECTION WAS ADAPTED FROM AN INSTALLATION           *
*             DATE CONVERSION ROUTINE TO AVOID HAVING MANY            *
*             DIFFERENT DATE CONVERSION ROUTINES.  IT IS              *
*             NECESSARY TO CONVERT THE DATE TO PACKED DECIMAL         *
*             FORM (AS IS THE DATE RETURNED BY TIME) TO               *
*             CONFORM TO THIS ROUTINE.                                *
*                                                                     *
***********************************************************************
         SPACE 2
DATECONV LA    R1,0(R1)                ZERO HIGH BYTE
         TM    DS1DSORG+1,X'08'        TEST FOR VSAM
         BO    DATECON1
         LR    R0,R1                   SAVE DATE 00YYDDDD - BINARY
         N     R0,=X'0000FFFF'                   0000DDDD - BINARY
         CVD   R0,PDEC                           0000DDDS - DECIMAL
         L     R0,PDEC+4                         0000DDDS - DECIMAL
         N     R1,=X'00FF0000'                   00YY0000 - BINARY
         SRA   R1,16                             000000YY - BINARY
         CVD   R1,PDEC                           00000YYS - DECIMAL
         L     R1,PDEC+4                         00000YYS - DECIMAL
         SLL   R1,12                             00YYS000 - DECIMAL
         N     R1,=X'00FF0000'                   00YY0000 - DECIMAL
         OR    R1,R0                             00YYDDDS - DECIMAL
DATECON1 ST    R1,WORK                 SAVE DATE
         LA    R1,PDEC                 SAVE OUTPUT AREA ADDRESS
         USING OUTPUT,R1               DEFINE OUTPUT AREA BASE REG
         CP    DATE,=P'0'              TEST FOR ZERO DATE
         BE    NODATE
         UNPK  JULIAN,DATE             UNPACK DATE
         OI    JULDAY+2,X'F0'          SET ZONE
         MVI   BLANK,C' '              SET BLANK
         MVC   TARGET,=PL3'0'          00 00 0C
         MVO   YEAR2,YEAR              00 0Y YC
         DP    TARGET,=P'4'            0Q QC RC
         CP    REM,=P'0'               TEST REMAINDER
         BE    LEAP
         CP    DAY,=P'59'              TEST FOR BEFORE FEB 29
         BNH   LEAP
         AP    DAY,=P'1'               ADJUST TO LEAP YEAR
LEAP     CP    DAY,=P'1'               TEST MINIMUM DAY
         BL    BADDAY
         CP    DAY,=P'366'             TEST MAXIMUM DAY
         BH    BADDAY
         LA    R6,CALTABLE             LOAD TABLE ADDRESS
         USING CALENDAR,R6             SET BASE ADDRESS
         ZAP   MONTHP,=P'1'            SET MONTH TO 1
LOOP     CP    DAY,DAYS                SEE IF MORE DAYS THAN THIS MNTH
         BNH   OUT
         SP    DAY,DAYS                SUBTRACT DAYS IN THIS MONTH
         AP    MONTHP,=P'1'            ADD 1 TO MONTH
         LA    R6,LEN(R6)              INCREMENT TO NEXT MONTH
         B     LOOP
OUT      UNPK  MO,MONTHP               UNPACK MONTH
         OI    MO+1,X'F0'              SET ZONE
         UNPK  DA,DAY                  UNPACK DAY
         OI    DA+1,X'F0'              SET ZONE
         MVI   SLASH1,C'/'             SET SLASH
         MVI   SLASH2,C'/'             SET SLASH
         B     DATERTRN
NODATE   MVC   0(12,R1),=CL12' '       BLANK OUTPUT FIELD
         B     DATERTRN
BADDAY   MVC   0(12,R1),=CL12'INVALID DATE'
DATERTRN BR    R5                      RETURN
         SPACE
***********************************************************************
*                                                                     *
*        CALENDAR TABLE - NUMBER OF DAYS IN EACH MONTH (LEAP YEAR)    *
*                                                                     *
***********************************************************************
         SPACE
CALTABLE DC    PL2'31'                 JANUARY
         DC    PL2'29'                 FEBRUARY
         DC    PL2'31'                 MARCH
         DC    PL2'30'                 APRIL
         DC    PL2'31'                 MAY
         DC    PL2'30'                 JUNE
         DC    PL2'31'                 JULY
         DC    PL2'31'                 AUGUST
         DC    PL2'30'                 SEPTEMBER
         DC    PL2'31'                 OCTOBER
         DC    PL2'30'                 NOVEMBER
         DC    PL2'31'                 DECEMBER
         EJECT
***********************************************************************
*                                                                     *
*        FINISHED PROCESSING VTOC AND CATALOG                         *
*                                                                     *
*        SORT RECORDS                                                 *
*                                                                     *
***********************************************************************
         SPACE 2
OVERFLOW SR    R1,R2                   REDUCE POINTER ONE ENTRY
         STM   R1,R3,SAVE              SAVE POINTERS
         PUT   SYSPRINT,ERROR9         DISPLAY ERROR MESSAGE
         PUT   SYSPRINT,HEADER         PRINT HEADER
EOD1     CLOSE SYSUT1                  CLOSE DATA SETS
         TM    SWITCH,X'01'            SEE IF ANY RECORDS
         BZ    NONE
         LM    R1,R3,SAVE              LOAD POINTERS
         LR    R3,R1                   RESET LIMIT TO LAST ENTRY
         L     R1,TABLEADR             LOAD TABLE ADDRESS
         STM   R1,R3,SAVE              SAVE POINTERS
         LR    R2,R1                   COPY FIRST TO R2
         #SORT FIELDS=(2,              KEY IN POS 2                    +
               44,                     KEY IS 44 BYTES LONG            +
               CH,                     DATA IS CHARACTER FORMAT        +
               A),                     SORT IN ASCENDING ORDER         +
               FIRST=(R2),             FIRST ENTRY ADDRESS IN REG 2    +
               LAST=(R3),              LAST ENTRY ADDRESS IN REG 3     +
               LENGTH=133              RECORDS ARE 133 BYTES LONG
         CVD   R9,PDEC                 CONVERT TOTAL TRACKS
         MVC   DEC,=X'4020202020202120'     SET UP EDIT MASK
         ED    DEC,PDEC+4              EDIT
         MVC   TOTAL,DEC+3             COPY INTO MESSAGE
         LA    R2,0                    INITIALIZE LINE COUNTER
         LA    R8,1                    INCREMENT
         LA    R9,50                   LIMIT
         PUT   SYSPRINT,HEADER1
         PUT   SYSPRINT,HEADER2
         LM    R5,R7,SAVE              LOAD POINTERS
         SR    R5,R6                   SUBTRACT LENGTH OF ONE ENTRY
         EJECT
***********************************************************************
*                                                                     *
*        PRINT REPORT AND PUNCH SCRATCH STATEMENTS                    *
*                                                                     *
***********************************************************************
         SPACE 2
READLINE BXH   R5,R6,ENDVOL            POINT TO NEXT RECORD
         BXLE  R2,R8,PRINT             INCREMENT LINE COUNT AND TEST
         PUT   SYSPRINT,HEADER         PRINT HEADERS
         PUT   SYSPRINT,HEADER1
         PUT   SYSPRINT,HEADER2
         LA    R2,1                    RESET LINE COUNTER
PRINT    PUT   SYSPRINT,0(R5)          PRINT LINE
         MVC   SCRATCHD,1(R5)          COPY DSNAME
         PUT   SYSUT2,SCRATCH1         PUT SCRATCH RECORDS
         PUT   SYSUT2,SCRATCH2
         B     READLINE                LOOP
         EJECT
***********************************************************************
*                                                                     *
*        NO UNCATALOGED OR MISCATALOGED DATA SETS ON VOLUME           *
*                                                                     *
***********************************************************************
         SPACE 2
NONE     PUT   SYSPRINT,OK
         B     CLOSEUT1
         EJECT
***********************************************************************
*                                                                     *
*        END OF VOLUME                                                *
*                                                                     *
***********************************************************************
         SPACE 2
ENDVOL   PUT   SYSPRINT,DONE
CLOSEUT1 CLOSE SYSUT1                  CLOSE SYSUT1
         B     READJFCB
         EJECT
***********************************************************************
*                                                                     *
*        OUTPUT COMPLETE - TERMINATE                                  *
*                                                                     *
***********************************************************************
         SPACE 2
RETURN   CLOSE (SYSPRINT,,SYSUT2)      CLOSE FILES
         TM    SWITCH,X'02'            SEE IF FREEMAIN REQUIRED
         BZ    RETURN2
         L     R1,TABLEADR             LOAD STORAGE ADDRESS
         FREEMAIN R,LV=26600,SP=1,A=(1)     FREE STORAGE
RETURN2  L     R15,CCODE               SET RETURN CODE
         $RTRN RC=(R15)                RETURN TO OS
         EJECT
***********************************************************************
*                                                                     *
*        DATA                                                         *
*                                                                     *
***********************************************************************
         SPACE
         LTORG
         SPACE
CCODE    DC    F'0'                    CONDITION CODE
TABLEADR DS    A                       ADDRESS OF STORAGE AREA
SAVE     DS    3A                      POINTERS TO ENTRIES IN STORAGE
COUNTER  DC    PL2'0'                  VOLUME COUNTER
HALF     DS    H                       WORK AREA
TRKPRCYL DS    H                       TRACKS PER CYLINDER
SWITCH   DC    X'00'                   INDICATORS
         DS    X                       NOT USED
PDEC     DS    D                       WORK AREA
DEC      DS    D                       WORK AREA
DEVCODE  DS    D                       DEVTYPE INFORMATION
DEVTABLE DC    X'00',CL7'SYSDA='         UNSUPPORTED
         DC    X'04',CL7'2311='
         DC    X'04',CL7'2301='
         DC    X'04',CL7'2303='
         DC    X'04',CL7'2302='
         DC    X'04',CL7'2321='
         DC    X'06',CL7'2305-1='
         DC    X'06',CL7'2305-2='
         DC    X'04',CL7'2314='
         DC    X'04',CL7'3330='
         DC    X'00',CL7'SYSDA='
         DC    X'04',CL7'3350='
         DC    X'00',CL7'SYSDA='
         DC    X'06',CL7'3330-1='
         DC    X'04',CL7'3380='
         DC    X'00',CL7'SYSDA='
         SPACE
WORK     DS    0F                      DATE
         DS    C                       FILLER
DATE     DS    0CL3                    JULIAN DATE - PACKED DECIMAL
YEAR     DS    C                       YEAR - NO SIGN
DAY      DS    CL2                     DD DS
MONTHP   DS    PL2                     0M MS
TARGET   DS    0CL3                    00 0Y YS  -  0Q QS RS
         DS    C                       0Q         PART OF QUOTIENT
YEAR2    DS    0PL2                    0Y YS      YEAR AND SIGN
         DS    C                       QS         QUOTIENT AND SIGN
REM      DS    C                       RS         REMAINDER AND SIGN
         SPACE
DSNAME   DS    CL44
VTOCDSNM DC    44X'04'                 VTOC DSNAME
LOCLIST  CAMLST NAME,DSNAME,,CATBLOCK
OBTAIN   CAMLST SEEK,DS1PTRDS,VOLSER,FMT3DSCB
         EJECT
FMT1DSCB DS    0F                      ALIGNMENT
         #VTCFMT1
         EJECT
         ORG   FMT1DSCB
         #VTCFMT4
         ORG   FMT1DSCB+148
         EJECT
FMT3DSCB DS    0F                      ALIGNMENT
         #VTCFMT3
         ORG   FMT3DSCB+148
         EJECT
ERROR2   DC    CL1' '                  CARRIAGE CONTROL          1    1
DSN2     DC    CL44' '                 DSNAME                   44   45
         DC    CL5' '                                            5   50
ALLOC2   DC    CL14' '                 ALLOCATION               14   64
         DC    CL5' '                                            5   69
CRDATE2  DC    CL8' '                  CREATION DATE             8   77
         DC    CL5' '                                            5   82
         DC    CL21' IS NOT CATALOGED ON '                      21  103
SER2     DC    CL6' '                  VOLUME SERIAL             6  109
         DC    CL24' '                 FILLER                   24  133
         SPACE 2
ERROR3   DC    CL1' '                  CARRIAGE CONTROL          1    1
DSN3     DC    CL44' '                 DSNAME                   44   45
         DC    CL5' '                                            5   50
ALLOC3   DC    CL14' '                 ALLOCATION               14   64
         DC    CL5' '                                            5   69
CRDATE3  DC    CL8' '                  CREATION DATE             8   77
         DC    CL5' '                                            5   82
         DC    CL17' IS NOT CATALOGED'                          17   99
         DC    CL34' '                 FILLER                   34  133
         SPACE 2
ERROR7   DC    CL1'-'                                            1    1
         DC    CL32'ERROR READING FORMAT 3 DSCB FOR '           32   33
DSN7     DC    CL44' '                                          44   77
         DC    CL56' '                                          56  133
         SPACE 2
ERROR8   DC    CL133'-UNABLE TO OPEN SYSUT2 - STEP TERMINATED'
         SPACE 2
ERROR9   DC    CL133'-LIST INCOMPLETE, TABLE EXCEEDED'
         SPACE 2
HEADER   DC    CL1'1'                                                 1
         DC    CL28'CATALOG/VTOC COMPARISON FOR '                    29
VOLSER   DC    CL6' '                                                35
         DC    CL5' '                                                40
HDRDATE  DC    CL8' '                                                48
         DC    CL3' '                                                51
TIME     DC    XL10'402020204B20204B2020'                            61
         DC    CL72' '                                              133
         SPACE 2
HEADER1  DC    CL1'0'                                                 1
         DC    CL44'-------------------DSNAME-------------------'    45
         DC    CL5' '                                                50
         DC    CL14'ALLOC  USED EX'                                  64
         DC    CL5' '                                                69
         DC    CL8'CR. DATE'                                         77
         DC    CL56' '                                              133
         SPACE 2
HEADER2  DC    CL133'0'                                             133
         SPACE 2
OK       DC    CL133'-NO UNCATALOGED OR MISCATALOGED DATA SETS ON VOLUM+
               E'
         SPACE 2
WARN     DC    CL133'-** WARNING **  DEVICE NAME COULD NOT BE DETERMINE+
               D.  SYSDA USED.  SCRATCH RECORDS MAY REQUIRED MODIFICATI+
               ON FOR MVS SYSTEMS.'
         SPACE 2
DONE     DC    CL50'0'                                               50
TOTAL    DC    CL5' '                                                55
         DC    CL78' '                                              133
         SPACE 2
SCRATCH1 DC    CL14'  SCRATCH VOL='                                  14
SCRATCHV DC    CL57' '                                               71
         DC    CL9'X'                                                80
         SPACE 2
SCRATCH2 DC    CL15' '                                               15
         DC    CL7'DSNAME='                                          22
SCRATCHD DC    CL44' '                                               66
         DC    CL14' '                                               80
         EJECT
SYSPRINT DCB   DDNAME=SYSPRINT,        DDNAME IS SYSPRINT              +
               DSORG=PS,               ORGAINZATION IS SEQUENTIAL      +
               MACRF=PM,               PUT MOVE                        +
               RECFM=FBA,              FIXED RECORDS WITH ASA CONTROL  +
               LRECL=133,              RECORD LENGTH IS 133            +
               BLKSIZE=133             BLOCKSIZE IS 133
         EJECT
SYSUT2   DCB   DDNAME=SYSUT2,          DDNAME IS SYSUT2                +
               DSORG=PS,               ORGAINZATION IS SEQUENTIAL      +
               MACRF=PM,               PUT MOVE                        +
               RECFM=FB,               FIXED, BLOCKED RECORDS          +
               LRECL=80,               RECORD LENGTH IS 80             +
               BLKSIZE=80              BLOCKSIZE IS 80
         EJECT
SYSUT1   DCB   DDNAME=VOLUMENN,        DDNAME IS VOLUMENN              +
               DSORG=PS,               ORGANIZATION IS SEQUENTIAL      +
               MACRF=R,                READ MACRO WILL BE USED         +
               KEYLEN=44,              44 BYTE KEYS (DSNAME)           +
               RECFM=F,                RECORD FORMAT IS FIXED          +
               BLKSIZE=96,             SIZE OF DSCB DATA PORTION       +
               EODAD=EOD1,             ENE OF DATA ROUTINE ADDRESS     +
               EXLST=EXLST1            EXIT LIST ADDRESS
         SPACE 2
EXLST1   DC    X'87',AL3(JFCBAREA)
         SPACE 2
JFCBAREA DS    0F                      AREA FOR JFCB
         IEFJFCBN
         EJECT
CATBLOCK DS    0D                      ALIGNMENT
         DS    265C                    AREA FOR CATALOG BLOCK
         EJECT
***********************************************************************
*                                                                     *
*        CALENDAR TABLE DSECT                                         *
*                                                                     *
***********************************************************************
         SPACE
CALENDAR DSECT
DAYS     DS    PL2                     DAYS IN MONTH
LEN      EQU   *-DAYS                  LENGTH OF ENTRY
         SPACE 2
***********************************************************************
*                                                                     *
*        OUTPUT AREA DSECT                                            *
*                                                                     *
***********************************************************************
         SPACE
OUTPUT   DSECT                         OUTPUT DSECT
MO       DS    CL2                     MONTH
SLASH1   DS    C                       SLASH
DA       DS    CL2                     DAY
SLASH2   DS    C                       SLASH
JULIAN   DS    0CL5                    JULIAN DATE - EBCDIC
YR       DS    CL2                     YEAR
JULDAY   DS    CL3                     JULIAN DAY
BLANK    DS    C                       BLANK
         END
